var vk=angular.module("vk",["ngRoute","ngResource","ngSanitize"]);vk.config(["$routeProvider","$locationProvider",function(e){e.when("/",{templateUrl:"templates/profile.html",controller:"Default"}).when("/profile",{templateUrl:"templates/profile.html",controller:"Default"}).when("/friends",{templateUrl:"templates/friends.html",controller:"Friends"}).when("/profile/:id",{templateUrl:"templates/friend.html",controller:"Friend"}).when("/photo",{templateUrl:"templates/photo.html",controller:"Photo"}).when("/album/:id",{templateUrl:"templates/album.html",controller:"Album"}).when("/video",{templateUrl:"templates/video.html",controller:"Video"}).when("/music",{templateUrl:"templates/music.html",controller:"Music"}).when("/im",{templateUrl:"templates/im.html",controller:"IM"}).when("/groups",{templateUrl:"templates/groups.html",controller:"Groups"}).when("/group/:id",{templateUrl:"templates/group.html",controller:"Group"}).when("/news",{templateUrl:"templates/news.html",controller:"News"}).when("/bookmarks",{templateUrl:"templates/bookmarks.html",controller:"Bookmarks"}).when("/settings",{templateUrl:"templates/settings.html",controller:"Settings"})}]),vk.config(function(e){e.resourceUrlWhitelist(["self","http://*.vk.me/**","http://*.vk.com/**","http://vk.com/**","http://rutube.ru/**","http://*.youtube.com/**"])}),vk.controller("Default",function(e){e.menuName=[{ru:"Моя Страница",en:"My Profile",url:"#/profile"},{ru:"Мои Друзья",en:"My Friends",url:"#/friends"},{ru:"Мои Фотографии",en:"My Photos",url:"#/photo"},{ru:"Мои Видеозаписи",en:"My Videos",url:"#/video"},{ru:"Мои Аудиозаписи",en:"My Music",url:"#/music"},{ru:"Мои Сообщения",en:"My Messages",url:"#/im"},{ru:"Мои Группы",en:"My Communities",url:"#/groups"},{ru:"Мои Новости",en:"My News",url:"#/news"},{ru:"Мои Закладки",en:"My Bookmarks",url:"#/bookmarks"},{ru:"Мои Настройки",en:"My Settings",url:"#/settings"}],e.specialNames={phone:{ru:"Телефон",en:"Phone"},groups:{ru:"Группы",en:"Groups"},friends:{ru:"Друзья",en:"Friends"},photosInAlbum:{ru:"Фотографий в альбоме",en:"Photos in album"}}}),vk.controller("Profile",function(e,o){o.jsonp(baseUrl("wall.get","&count=50&filter=all&extended=1")).success(function(o){e.profilePostCounter=o.response.wall[0],e.profileWall=o.response.wall.slice(1),e.profileGroups=o.response.groups,e.profilePeople=o.response.profiles,console.log(o)}).error(function(e){console.log("Error: "+e)}),e.insertAttach=function(e,o){var r,n,t;switch(e){case"photo":return n=o.photo.src,t=o.photo.src_big,r='<a href="'+t+'" class="b-wall__attach-photo-link"><img src="'+n+'" class="b-wall__attach-photo" /></a>'}}}),vk.controller("Friends",function(e,o){var r=function(o){e.friends=o.response};o.jsonp(baseUrl("friends.get","&fields=uid,first_name,last_name,nickname,sex,bdate,city,country,timezone,photo_medium,photo_big,domain,has_mobile,rate,contacts")).success(function(e){r(e),console.log(e)}).error(function(e){console.log(e)})}),vk.controller("Friend",function(){}),vk.controller("Photo",function(e,o){o.jsonp(baseUrl("photos.getAlbums","&need_covers=1")).success(function(o){e.albums=o.response,console.log(o)}).error(function(e){console.log("Error: "+e)})}),vk.controller("Album",function(e,o,r){o.jsonp(baseUrl("photos.get","&aid="+r.id)).success(function(o){e.album=o.response,console.log(o)}).error(function(e){console.log("Error: "+e)})}),vk.controller("Video",function(e,o){o.jsonp(baseUrl("video.get","&count=30")).success(function(o){e.videos=o.response.slice(1),console.log(o)}).error(function(e){console.log(e)})}),vk.controller("Music",function(e,o){o.jsonp(baseUrl("audio.get","&count=30")).success(function(o){e.tracks=o.response,console.log(o)}).error(function(e){console.log(e)})}),vk.controller("IM",function(e,o){o.jsonp(baseUrl("messages.get","&count=50&filters=4")).success(function(o){e.im=o.response,console.log(o)}).error(function(e){console.log(e)})}),vk.controller("Groups",function(e,o){o.jsonp(baseUrl("groups.get","&extended=1&fields=country,description,members_count,counters")).success(function(o){e.groups=o.response,console.log(o)}).error(function(e){console.log(e)}),e.pageType=function(e){switch(e){case"page":return"Страница";case"group":return"Группа";case"event":return"Мероприятие";default:return"Страница"}}}),vk.controller("Group",function(e,o,r){o.jsonp(baseUrl("","owner_id="+r.id+"&filter=all&extented=1")).success(function(o){e.groupWall=o.response,console.log(o)}).error(function(e){console.log("Error: "+e)})}),vk.controller("News",function(){}),vk.controller("Bookmarks",function(){}),vk.controller("Settings",function(){}),vk.directive("bFancybox",function(){return{restrict:"C",link:function(){$(".b-fancybox").fancybox({padding:0})}}});var baseUrl=function(e,o){return"https://api.vk.com/method/"+e+"?uid="+id+o+"&access_token="+window.token+"&callback=JSON_CALLBACK"};